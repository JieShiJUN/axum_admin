import{s as e,r as u,d as l,v as t}from"./index-174ad176.js";import{i as a,G as o,C as n,p as r,l as V}from"./index.js";import{D as s}from"./dict-tag-15f2a908.js";import{u as d,P as i,a as m}from"./pagination-87b07e34.js";import{R as c}from"./right-tool-bar-f10e816b.js";import{u as p}from"./useFormUtil-98c17c20.js";import{h as f}from"./usePermission-16d8d5ac.js";import{u as E}from"./useTableUtil-0e4d2f9a.js";import{s as h}from"./constDynamicRoutes-5c9c22de.js";import{d as C}from"./dict-2940434e.js";import"./_plugin-vue_export-helper-0909ef10.js";const _={key:0},w={key:1},N={class:"dialog-footer"},x=Vue.defineComponent({name:h.scheduledTasks.path}),v=Vue.defineComponent({...x,setup(h){const{t:x}=VueI18n.useI18n({useScope:"global"}),v=Vue.ref(),P=Vue.ref(!0),y=Vue.ref({}),g=Vue.ref(!1),b=a(C.sysCommonStatus,C.sysApiMethod,C.sysOperType),{formReset:k}=p(),{useTableSelectChange:T}=E(),{handleSelectionChangeFn:B,ids:S,values:D,selected:F}=T(),I=e=>B(e,"oper_id","oper_id"),j=Vue.ref({page_num:1,page_size:10}),U=Vue.ref([]),{list:M,getListFn:q,total:K}=d(o.getList,j,U),R=()=>{k(v.value),U.value=[],q()},O=async()=>{await ElementPlus.ElMessageBox.confirm("是否确认清空所有操作日志数据项?","清空确认",{type:"warning"}).then((async()=>{const{execute:e}=V(o.clean);await e(),ElementPlus.ElMessage.success("清空操作日志成功")})).catch((()=>{ElementPlus.ElMessage.info("取消情况操作")})),q()};return(a,V)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.withDirectives(Vue.createVNode(Vue.unref(ElementPlus.ElForm),{ref_key:"queryRef",ref:v,inline:!0,model:j.value,"label-width":"68px",class:"base-form"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"系统模块",prop:"title"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:j.value.title,"onUpdate:modelValue":V[0]||(V[0]=e=>j.value.title=e),placeholder:"请输入系统模块",clearable:"",style:{width:"240px"},onKeyup:Vue.withKeys(Vue.unref(q),["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作人员",prop:"oper_name"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:j.value.oper_name,"onUpdate:modelValue":V[1]||(V[1]=e=>j.value.oper_name=e),placeholder:"请输入操作人员",clearable:"",style:{width:"240px"},onKeyup:Vue.withKeys(Vue.unref(q),["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作类型",prop:"operator_type"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElSelect),{modelValue:j.value.operator_type,"onUpdate:modelValue":V[2]||(V[2]=e=>j.value.operator_type=e),placeholder:"操作类型",clearable:"",style:{width:"240px"}},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(b)[Vue.unref(C).sysOperType],(e=>(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElOption),{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作状态",prop:"status"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElSelect),{modelValue:j.value.status,"onUpdate:modelValue":V[3]||(V[3]=e=>j.value.status=e),clearable:!0,placeholder:"状态"},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(b)[Vue.unref(C).sysCommonStatus],(e=>(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElOption),{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作时间"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElDatePicker),{modelValue:U.value,"onUpdate:modelValue":V[4]||(V[4]=e=>U.value=e),"end-placeholder":"结束日期","range-separator":"-","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),null,{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{icon:Vue.unref(e),type:"primary",onClick:Vue.unref(q)},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(x)("common.search")),1)])),_:1},8,["icon","onClick"]),Vue.createVNode(Vue.unref(ElementPlus.ElButton),{icon:Vue.unref(u),onClick:R},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(x)("common.reset")),1)])),_:1},8,["icon"])])),_:1})])),_:1},8,["model"]),[[Vue.vShow,P.value]]),Vue.createVNode(Vue.unref(ElementPlus.ElRow),{gutter:10,class:"m-b-8px",style:{height:"35px"}},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:1.5},{default:Vue.withCtx((()=>[Vue.unref(f)(Vue.unref(n).delete)?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElButton),{key:0,type:"danger",plain:"",icon:Vue.unref(l),disabled:!Vue.unref(F),onClick:V[5]||(V[5]=e=>(async e=>{await m(o.delete,"oper_id",S,"oper_id",D,"oper_ids",e)&&q()})())},{default:Vue.withCtx((()=>[Vue.createTextVNode(" 删除 ")])),_:1},8,["icon","disabled"])):Vue.createCommentVNode("",!0)])),_:1},8,["span"]),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:1.5},{default:Vue.withCtx((()=>[Vue.unref(f)(Vue.unref(n).clean)?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElButton),{key:0,type:"danger",plain:"",icon:Vue.unref(l),onClick:O},{default:Vue.withCtx((()=>[Vue.createTextVNode(" 清空 ")])),_:1},8,["icon"])):Vue.createCommentVNode("",!0)])),_:1},8,["span"]),Vue.createVNode(c,{showSearch:P.value,"onUpdate:showSearch":V[6]||(V[6]=e=>P.value=e),onQueryTable:Vue.unref(q)},null,8,["showSearch","onQueryTable"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTable),{data:Vue.unref(M),onSelectionChange:I,"tooltip-effect":"light"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{type:"selection",width:"55",align:"center"}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"日志编号",align:"center",prop:"oper_id","show-overflow-tooltip":""}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"系统模块",align:"center",prop:"title","show-overflow-tooltip":""}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"操作类型",align:"center",prop:"operator_type"},{default:Vue.withCtx((e=>[Vue.createVNode(s,{options:Vue.unref(b)[Vue.unref(C).sysOperType],value:e.row.operator_type},null,8,["options","value"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"请求方式",align:"center",prop:"request_method"},{default:Vue.withCtx((e=>[Vue.createVNode(s,{options:Vue.unref(b)[Vue.unref(C).sysApiMethod],value:e.row.request_method},null,8,["options","value"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"操作人员",align:"center",prop:"oper_name","show-overflow-tooltip":!0,width:"120"}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"地址",align:"center",prop:"oper_location",width:"130","show-overflow-tooltip":!0}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"操作状态",align:"center",prop:"status"},{default:Vue.withCtx((e=>[Vue.createVNode(s,{options:Vue.unref(b)[Vue.unref(C).sysCommonStatus],value:e.row.status},null,8,["options","value"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"耗时(μs)",align:"center",prop:"duration"}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"操作日期",align:"center",prop:"oper_time",width:"180"},{default:Vue.withCtx((e=>[Vue.createElementVNode("span",null,Vue.toDisplayString(Vue.unref(r)(e.row.oper_time)),1)])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:Vue.withCtx((e=>[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{link:"",icon:Vue.unref(t),onClick:u=>{return l=e.row,y.value=l,void(g.value=!0);var l}},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(x)("common.detail")),1)])),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data"]),Vue.withDirectives(Vue.createVNode(i,{page:j.value.page_num,"onUpdate:page":V[7]||(V[7]=e=>j.value.page_num=e),limit:j.value.page_size,"onUpdate:limit":V[8]||(V[8]=e=>j.value.page_size=e),total:Vue.unref(K),onPagination:Vue.unref(q)},null,8,["page","limit","total","onPagination"]),[[Vue.vShow,Vue.unref(K)>0]]),g.value?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElDialog),{key:0,modelValue:g.value,"onUpdate:modelValue":V[10]||(V[10]=e=>g.value=e),title:"操作日志详细",width:"700px","append-to-body":""},{footer:Vue.withCtx((()=>[Vue.createElementVNode("div",N,[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{onClick:V[9]||(V[9]=e=>g.value=!1)},{default:Vue.withCtx((()=>[Vue.createTextVNode(" 关 闭 ")])),_:1})])])),default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElForm),{model:y.value,"label-width":"100px"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElRow),null,{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作模块："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.title),1)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"请求方式："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.request_method),1)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:24},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"登录信息："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.oper_name)+" / "+Vue.toDisplayString(y.value.oper_ip)+" / "+Vue.toDisplayString(y.value.oper_location),1)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:24},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"请求地址："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.oper_url),1)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:24},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作方法："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.method),1)])),_:1})])),_:1}),"GET"!=y.value.request_method?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElCol),{key:0,span:24},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"请求参数："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.oper_param),1)])),_:1})])),_:1})):Vue.createCommentVNode("",!0),"GET"==y.value.request_method?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElCol),{key:1,span:24},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"路径参数："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.path_param),1)])),_:1})])),_:1})):Vue.createCommentVNode("",!0),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:24},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作耗时："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.duration)+" 微秒 ",1)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:24},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"返回参数："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.json_result),1)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作状态："},{default:Vue.withCtx((()=>["1"===y.value.status?(Vue.openBlock(),Vue.createElementBlock("div",_,"正常")):"0"===y.value.status?(Vue.openBlock(),Vue.createElementBlock("div",w,"失败")):Vue.createCommentVNode("",!0)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"操作时间："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(r)(y.value.oper_time)),1)])),_:1})])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:24},{default:Vue.withCtx((()=>["0"===y.value.status?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElFormItem),{key:0,label:"异常信息："},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(y.value.error_msg),1)])),_:1})):Vue.createCommentVNode("",!0)])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])):Vue.createCommentVNode("",!0)]))}});export{v as default};
