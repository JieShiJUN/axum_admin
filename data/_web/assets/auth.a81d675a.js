import{l as e,u as t}from"./menu.d9e18d07.js";import{s as u,_ as l}from"./index.74f0e013.js";function a(e){return u({url:"/system/api_db/add",method:"post",data:e})}const o={class:"app-container"},V=Vue.createTextVNode("搜索"),r=Vue.createTextVNode("重置"),n={key:0},d=Vue.createTextVNode("数据库"),c=Vue.createTextVNode(">"),i=Vue.createElementVNode("div",null,[Vue.createTextVNode(" 日志记录方式: "),Vue.createElementVNode("br"),Vue.createTextVNode("分为四种方式: "),Vue.createElementVNode("br"),Vue.createTextVNode("不记录 "),Vue.createElementVNode("br"),Vue.createTextVNode("文件记录 "),Vue.createElementVNode("br"),Vue.createTextVNode("数据库记录 "),Vue.createElementVNode("br"),Vue.createTextVNode("文件+数据库记录 ")],-1),p=Vue.createTextVNode(" 日志记录 "),m=Vue.createElementVNode("div",null,[Vue.createTextVNode(" 日志记录方式: "),Vue.createElementVNode("br"),Vue.createTextVNode("分为三种方式: "),Vue.createElementVNode("br"),Vue.createTextVNode("不缓存:每次都从数据库获取，用于经常更新的数据 "),Vue.createElementVNode("br"),Vue.createTextVNode("按访问人:用于缓存每个人访问数据都不同的数据 "),Vue.createElementVNode("br"),Vue.createTextVNode("公共缓存:用于数据更新较少，不区分个人的数据 ")],-1),s=Vue.createTextVNode(" 缓存方式 "),h={class:"dialog-footer"},v=Vue.createTextVNode("确 定"),f=Vue.createTextVNode("取 消"),w=Vue.defineComponent({name:"auth_list"});var _=l(Object.assign(w,{setup(l){const{proxy:w}=Vue.getCurrentInstance(),{sys_normal_disable:_,sys_api_method:N,db:x,api_cache_method:C,api_log_method:b}=w.useDict("sys_normal_disable","sys_api_method","db","api_cache_method","api_log_method"),k=Vue.ref([]),g=Vue.ref([]),y=Vue.ref(""),B=Vue.ref(""),E=Vue.ref(!0),T=Vue.ref(!1),D=Vue.ref(null),F=Vue.ref(null),S=Vue.ref(!0),U=Vue.ref(0),L=Vue.ref(""),P=Vue.reactive({queryParams:{page_num:1,page_size:10,menu_name:void 0,status:void 0,menu_type:"F"}}),{queryParams:R}=Vue.toRefs(P);function q(e){let t=0;return e.forEach((e=>{t=Math.max(t,e.length)})),t}function j(){E.value=!0,e(R.value).then((e=>{k.value=e.list,U.value=e.total,E.value=!1}))}async function z(e){y.value=e.id,D.value=e.data_cache_method,F.value=e.log_method,B.value=e.method;const t=await(l={api_id:y.value},u({url:"/system/api_db/get_by_id",method:"get",params:l}));var l;g.value=t.map((e=>e.db)),T.value=!0,L.value=e.menu_name+"  数据库关联+日志+缓存"}function G(){R.value.page_num=1,j()}function I(){w.resetForm("queryRef"),G()}function K(){T.value=!1}async function A(){const e={api_id:y.value,dbs:g.value},u={id:y.value,data_cache_method:D.value,log_method:F.value};await Promise.all([a(e),t(u)]),w.$modal.msgSuccess("数据关联更新成功"),T.value=!1,j()}return j(),(e,t)=>{const u=Vue.resolveComponent("el-input"),l=Vue.resolveComponent("el-form-item"),a=Vue.resolveComponent("el-option"),w=Vue.resolveComponent("el-select"),y=Vue.resolveComponent("el-button"),P=Vue.resolveComponent("el-form"),M=Vue.resolveComponent("el-table-column"),O=Vue.resolveComponent("dict-tag"),Y=Vue.resolveComponent("el-popover"),$=Vue.resolveComponent("el-tooltip"),H=Vue.resolveComponent("el-table"),J=Vue.resolveComponent("pagination"),Q=Vue.resolveComponent("el-checkbox"),W=Vue.resolveComponent("el-checkbox-group"),X=Vue.resolveComponent("el-col"),Z=Vue.resolveComponent("el-row"),ee=Vue.resolveComponent("info-filled"),te=Vue.resolveComponent("el-icon"),ue=Vue.resolveComponent("el-dialog"),le=Vue.resolveDirective("hasPermi"),ae=Vue.resolveDirective("loading");return Vue.openBlock(),Vue.createElementBlock("div",o,[Vue.withDirectives(Vue.createVNode(P,{model:Vue.unref(R),ref:"queryRef",inline:!0,"label-width":"68px"},{default:Vue.withCtx((()=>[Vue.createVNode(l,{label:"菜单名称",prop:"menu_name"},{default:Vue.withCtx((()=>[Vue.createVNode(u,{modelValue:Vue.unref(R).menu_name,"onUpdate:modelValue":t[0]||(t[0]=e=>Vue.unref(R).menu_name=e),placeholder:"请输入菜单名称",clearable:"",onKeyup:Vue.withKeys(G,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(l,{label:"状态",prop:"status"},{default:Vue.withCtx((()=>[Vue.createVNode(w,{modelValue:Vue.unref(R).status,"onUpdate:modelValue":t[1]||(t[1]=e=>Vue.unref(R).status=e),placeholder:"菜单状态",clearable:""},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(_),(e=>(Vue.openBlock(),Vue.createBlock(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),Vue.createVNode(l,{label:"方法",prop:"method"},{default:Vue.withCtx((()=>[Vue.createVNode(w,{modelValue:Vue.unref(R).method,"onUpdate:modelValue":t[2]||(t[2]=e=>Vue.unref(R).method=e),placeholder:"菜单状态",clearable:""},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(N),(e=>(Vue.openBlock(),Vue.createBlock(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),Vue.createVNode(l,null,{default:Vue.withCtx((()=>[Vue.createVNode(y,{type:"primary",icon:"Search",onClick:G},{default:Vue.withCtx((()=>[V])),_:1}),Vue.createVNode(y,{icon:"Refresh",onClick:I},{default:Vue.withCtx((()=>[r])),_:1})])),_:1})])),_:1},8,["model"]),[[Vue.vShow,S.value]]),Vue.withDirectives((Vue.openBlock(),Vue.createBlock(H,{data:k.value},{default:Vue.withCtx((()=>[Vue.createVNode(M,{label:"菜单编号",align:"center",width:"100","show-overflow-tooltip":"",prop:"order_sort"}),Vue.createVNode(M,{label:"菜单名称",align:"center",prop:"menu_name","show-overflow-tooltip":""}),Vue.createVNode(M,{label:"菜单api",align:"center",prop:"api"}),Vue.createVNode(M,{label:"请求方法",align:"center",prop:"method"},{default:Vue.withCtx((e=>[Vue.createVNode(O,{options:Vue.unref(N),value:e.row.method},null,8,["options","value"])])),_:1}),Vue.createVNode(M,{prop:"method",label:"数据权限",width:"80"},{default:Vue.withCtx((e=>["GET"==e.row.method?(Vue.openBlock(),Vue.createBlock(O,{key:0,options:Vue.unref(_),value:e.row.data_scope},null,8,["options","value"])):Vue.createCommentVNode("v-if",!0)])),_:1}),Vue.createVNode(M,{align:"center",label:"数据库"},{default:Vue.withCtx((e=>[Vue.createVNode(Y,{placement:"top-start",title:"数据库",trigger:"hover",width:9*q(e.row.dbs)+5},{reference:Vue.withCtx((()=>[Vue.createElementVNode("span",null,Vue.toDisplayString(e.row.dbs.length>1?e.row.dbs[0]+" ↑ ":0==e.row.dbs.length?"":e.row.dbs[0]),1)])),default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.row.dbs,(e=>(Vue.openBlock(),Vue.createElementBlock("li",{key:e},Vue.toDisplayString(e),1)))),128))])),_:2},1032,["width"])])),_:1}),Vue.createVNode(M,{align:"center",label:"APIs",width:"200"},{default:Vue.withCtx((e=>[Vue.createVNode(Y,{placement:"top-start",title:"APIs",trigger:"hover",width:9*q(e.row.apis)+5},{reference:Vue.withCtx((()=>[Vue.createElementVNode("span",null,Vue.toDisplayString(e.row.apis.length>1?e.row.apis[0]+" ↑ ":0==e.row.apis.length?"":e.row.apis[0]),1)])),default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.row.apis,(e=>(Vue.openBlock(),Vue.createElementBlock("li",{key:e},Vue.toDisplayString(e),1)))),128))])),_:2},1032,["width"])])),_:1}),Vue.createVNode(M,{label:"日志",align:"center",prop:"log_method"},{default:Vue.withCtx((e=>[Vue.createVNode(O,{options:Vue.unref(b),value:e.row.log_method},null,8,["options","value"])])),_:1}),Vue.createVNode(M,{label:"缓存",align:"center",prop:"data_cache_method"},{default:Vue.withCtx((e=>["GET"!==e.row.method?(Vue.openBlock(),Vue.createElementBlock("div",n)):(Vue.openBlock(),Vue.createBlock(O,{key:1,options:Vue.unref(C),value:e.row.data_cache_method},null,8,["options","value"]))])),_:1}),Vue.createVNode(M,{label:"状态",align:"center",prop:"status"},{default:Vue.withCtx((e=>[Vue.createVNode(O,{options:Vue.unref(_),value:e.row.status},null,8,["options","value"])])),_:1}),Vue.createVNode(M,{label:"创建时间",align:"center",prop:"created_at",width:"180"},{default:Vue.withCtx((t=>[Vue.createElementVNode("span",null,Vue.toDisplayString(e.parseTime(t.row.created_at)),1)])),_:1}),Vue.withDirectives((Vue.openBlock(),Vue.createBlock(M,{label:"操作",align:"center",width:"200","class-name":"small-padding fixed-width"},{default:Vue.withCtx((e=>["F"==e.row.menu_type?(Vue.openBlock(),Vue.createBlock($,{key:0,content:"数据库关联",placement:"top"},{default:Vue.withCtx((()=>[Vue.withDirectives((Vue.openBlock(),Vue.createBlock(y,{style:{color:"green"},type:"text",icon:"DataBoard",onClick:t=>z(e.row)},{default:Vue.withCtx((()=>[d])),_:2},1032,["onClick"])),[[le,["system/menu/delete"]]]),c])),_:2},1024)):Vue.createCommentVNode("v-if",!0)])),_:1})),[[le,["system/menu/delete"]]])])),_:1},8,["data"])),[[ae,E.value]]),Vue.withDirectives(Vue.createVNode(J,{total:U.value,page:Vue.unref(R).page_num,"onUpdate:page":t[3]||(t[3]=e=>Vue.unref(R).page_num=e),limit:Vue.unref(R).page_size,"onUpdate:limit":t[4]||(t[4]=e=>Vue.unref(R).page_size=e),onPagination:j},null,8,["total","page","limit"]),[[Vue.vShow,U.value>0]]),Vue.createCommentVNode(" 添加或修改权限数据对话框 "),Vue.createVNode(ue,{title:L.value,modelValue:T.value,"onUpdate:modelValue":t[8]||(t[8]=e=>T.value=e),width:"680px","append-to-body":""},{footer:Vue.withCtx((()=>[Vue.createElementVNode("div",h,[Vue.createVNode(y,{type:"primary",onClick:A},{default:Vue.withCtx((()=>[v])),_:1}),Vue.createVNode(y,{onClick:K},{default:Vue.withCtx((()=>[f])),_:1})])])),default:Vue.withCtx((()=>[Vue.createVNode(P,{ref:"menuRef","label-width":"100px"},{default:Vue.withCtx((()=>[Vue.createVNode(Z,null,{default:Vue.withCtx((()=>[Vue.createVNode(X,{span:24},{default:Vue.withCtx((()=>[Vue.createVNode(l,{label:"关联数据表"},{default:Vue.withCtx((()=>[Vue.createVNode(W,{modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=e=>g.value=e)},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(x),(e=>(Vue.openBlock(),Vue.createBlock(Q,{style:{width:"150px"},label:e.value,key:e.value},{default:Vue.withCtx((()=>[Vue.createVNode($,{content:e.label+" : "+e.value,placement:"top"},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(e.value),1)])),_:2},1032,["content"])])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1}),Vue.createVNode(Z,null,{default:Vue.withCtx((()=>[Vue.createVNode(X,{span:12},{default:Vue.withCtx((()=>[Vue.createVNode(l,null,{label:Vue.withCtx((()=>[Vue.createElementVNode("span",null,[Vue.createVNode($,{placement:"top"},{content:Vue.withCtx((()=>[i])),default:Vue.withCtx((()=>[Vue.createVNode(te,null,{default:Vue.withCtx((()=>[Vue.createVNode(ee)])),_:1})])),_:1}),p])])),default:Vue.withCtx((()=>[Vue.createVNode(w,{modelValue:F.value,"onUpdate:modelValue":t[6]||(t[6]=e=>F.value=e),placeholder:"日志记录方式"},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(b),(e=>(Vue.openBlock(),Vue.createBlock(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),"GET"===B.value?(Vue.openBlock(),Vue.createBlock(X,{key:0,span:12},{default:Vue.withCtx((()=>[Vue.createVNode(l,null,{label:Vue.withCtx((()=>[Vue.createElementVNode("span",null,[Vue.createVNode($,{placement:"top"},{content:Vue.withCtx((()=>[m])),default:Vue.withCtx((()=>[Vue.createVNode(te,null,{default:Vue.withCtx((()=>[Vue.createVNode(ee)])),_:1})])),_:1}),s])])),default:Vue.withCtx((()=>[Vue.createVNode(w,{modelValue:D.value,"onUpdate:modelValue":t[7]||(t[7]=e=>D.value=e),placeholder:"缓存方式"},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(C),(e=>(Vue.openBlock(),Vue.createBlock(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})):Vue.createCommentVNode("v-if",!0)])),_:1})])),_:1},512)])),_:1},8,["title","modelValue"])])}}}),[["__file","E:/LingDu/rust/poem/RuoYi-Vue3/src/views/system/menu/auth.vue"]]);export{_ as default};
