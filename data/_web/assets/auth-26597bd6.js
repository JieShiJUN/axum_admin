import{s as e,r as u,f as l}from"./index-174ad176.js";import{i as t,M as a,r as o,p as n,B as r}from"./index.js";import{D as V}from"./dict-tag-15f2a908.js";import{u as i,P as m}from"./pagination-87b07e34.js";import{u as s}from"./useFormUtil-98c17c20.js";import{h as c}from"./usePermission-16d8d5ac.js";import{s as d}from"./constDynamicRoutes-5c9c22de.js";import{d as p}from"./dict-2940434e.js";import{_ as f}from"./auth-dialog.vue_vue_type_script_setup_true_name_menu-dialog_lang-c22d703f.js";import"./_plugin-vue_export-helper-0909ef10.js";const h={key:0},w=Vue.defineComponent({name:d.menu_auth.path}),E=Vue.defineComponent({...w,setup(d){const{t:w}=VueI18n.useI18n({useScope:"global"}),E=Vue.ref(),{formReset:g}=s(),b=t(p.sysNormalDisable,p.sysApiMethod,p.apiCacheMethod,p.apiLogMethod),_=Vue.ref(!0),v=Vue.ref(!1),C=Vue.ref(""),k=Vue.ref({}),N=Vue.ref({page_num:1,page_size:10,menu_type:a.F}),{list:x,getListFn:P,total:y}=i(o.getAuthList,N),B=e=>{let u=0;return e.forEach((e=>{u=Math.max(u,e.length)})),u},T=()=>{v.value=!1,P()};return(t,a)=>(Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.withDirectives(Vue.createVNode(Vue.unref(ElementPlus.ElForm),{ref_key:"queryRef",ref:E,inline:!0,model:N.value,class:"base-form","label-width":"68px"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:Vue.unref(w)("menu.name"),prop:"menu_name"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:N.value.menu_name,"onUpdate:modelValue":a[0]||(a[0]=e=>N.value.menu_name=e),placeholder:Vue.unref(w)("menu.nameTip"),clearable:"",onKeyup:Vue.withKeys(Vue.unref(P),["enter"])},null,8,["modelValue","placeholder","onKeyup"])])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:Vue.unref(w)("menu.status"),prop:"status"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElSelect),{modelValue:N.value.status,"onUpdate:modelValue":a[1]||(a[1]=e=>N.value.status=e),clearable:!0,placeholder:Vue.unref(w)("menu.status")},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(b)[Vue.unref(p).sysNormalDisable],(e=>(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElOption),{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:Vue.unref(w)("menu.method"),prop:"method"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElSelect),{modelValue:N.value.method,"onUpdate:modelValue":a[2]||(a[2]=e=>N.value.method=e),placeholder:Vue.unref(w)("menu.method"),clearable:""},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(b)[Vue.unref(p).sysApiMethod],(e=>(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElOption),{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),null,{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{icon:Vue.unref(e),type:"primary",onClick:Vue.unref(P)},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(w)("common.search")),1)])),_:1},8,["icon","onClick"]),Vue.createVNode(Vue.unref(ElementPlus.ElButton),{icon:Vue.unref(u),onClick:a[3]||(a[3]=e=>(g(E.value),void P()))},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(w)("common.reset")),1)])),_:1},8,["icon"])])),_:1})])),_:1},8,["model"]),[[Vue.vShow,_.value]]),Vue.createVNode(Vue.unref(ElementPlus.ElTable),{data:Vue.unref(x),"tooltip-effect":"light"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("menu.id"),align:"center",prop:"order_sort","show-overflow-tooltip":"",width:"100"},null,8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("menu.name"),align:"center",prop:"menu_name","show-overflow-tooltip":""},null,8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{align:"center",label:"api","show-overflow-tooltip":"",width:"150px"},{default:Vue.withCtx((e=>[Vue.createVNode(Vue.unref(ElementPlus.ElPopover),{placement:"top-start",title:"API",trigger:"hover"},{reference:Vue.withCtx((()=>[Vue.createElementVNode("span",null,Vue.toDisplayString(e.row.api),1)])),default:Vue.withCtx((()=>[Vue.createTextVNode(" "+Vue.toDisplayString(e.row.api),1)])),_:2},1024)])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("menu.method"),align:"center",prop:"method"},{default:Vue.withCtx((e=>[Vue.createVNode(V,{options:Vue.unref(b)[Vue.unref(p).sysApiMethod],value:e.row.method},null,8,["options","value"])])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("menu.dataScope"),align:"center",prop:"data_scope",width:"100"},{default:Vue.withCtx((e=>["GET"==e.row.method?(Vue.openBlock(),Vue.createBlock(V,{key:0,options:Vue.unref(b)[Vue.unref(p).sysNormalDisable],value:e.row.data_scope},null,8,["options","value"])):(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElTag),{key:1},{default:Vue.withCtx((()=>[Vue.createTextVNode("not support")])),_:1}))])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("menu.database"),align:"center",width:"160px"},{default:Vue.withCtx((e=>[Vue.createVNode(Vue.unref(ElementPlus.ElPopover),{title:Vue.unref(w)("menu.database"),width:9*B(e.row.dbs)+5,placement:"top-start",trigger:"hover"},{reference:Vue.withCtx((()=>[Vue.createElementVNode("span",null,Vue.toDisplayString(e.row.dbs.length>1?e.row.dbs[0]+" ↑ ":0==e.row.dbs.length?"":e.row.dbs[0]),1)])),default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.row.dbs,((e,u)=>(Vue.openBlock(),Vue.createElementBlock("li",{key:e+u},Vue.toDisplayString(e),1)))),128))])),_:2},1032,["title","width"])])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{align:"center",label:"APIs",width:"200"},{default:Vue.withCtx((e=>[Vue.createVNode(Vue.unref(ElementPlus.ElPopover),{width:9*B(e.row.apis)+5,placement:"top-start",title:"APIs",trigger:"hover"},{reference:Vue.withCtx((()=>[Vue.createElementVNode("span",null,Vue.toDisplayString(e.row.apis.length>1?e.row.apis[0]+" ↑ ":0==e.row.apis.length?"":e.row.apis[0]),1)])),default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.row.apis,((e,u)=>(Vue.openBlock(),Vue.createElementBlock("li",{key:e+u},Vue.toDisplayString(e),1)))),128))])),_:2},1032,["width"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("common.log"),align:"center",prop:"log_method"},{default:Vue.withCtx((e=>[Vue.createVNode(V,{options:Vue.unref(b)[Vue.unref(p).apiLogMethod],value:e.row.log_method},null,8,["options","value"])])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("common.cache"),align:"center",prop:"data_cache_method"},{default:Vue.withCtx((e=>["GET"!==e.row.method?(Vue.openBlock(),Vue.createElementBlock("div",h)):(Vue.openBlock(),Vue.createBlock(V,{key:1,options:Vue.unref(b)[Vue.unref(p).apiCacheMethod],value:e.row.data_cache_method},null,8,["options","value"]))])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("common.status"),align:"center",prop:"status"},{default:Vue.withCtx((e=>[Vue.createVNode(V,{options:Vue.unref(b)[Vue.unref(p).sysNormalDisable],value:e.row.status},null,8,["options","value"])])),_:1},8,["label"]),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:Vue.unref(w)("common.createTime"),align:"center",prop:"created_at",width:"180"},{default:Vue.withCtx((e=>[Vue.createElementVNode("span",null,Vue.toDisplayString(Vue.unref(n)(e.row.created_at)),1)])),_:1},8,["label"]),Vue.unref(c)(Vue.unref(o).updateLogCache,Vue.unref(r).edit)?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElTableColumn),{key:0,label:Vue.unref(w)("common.operation"),align:"center","class-name":"small-padding fixed-width",width:"200"},{default:Vue.withCtx((e=>["F"==e.row.menu_type?(Vue.openBlock(),Vue.createBlock(Vue.unref(ElementPlus.ElTooltip),{key:0,content:Vue.unref(w)("menu.dbRelation"),effect:"light",placement:"top"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{icon:Vue.unref(l),link:"",style:{color:"green"},onClick:u=>{return l=e.row,k.value=l,C.value=l.menu_name+"  数据库关联+日志+缓存",void(v.value=!0);var l}},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(Vue.unref(w)("menu.dbRelation")),1)])),_:2},1032,["icon","onClick"])])),_:2},1032,["content"])):Vue.createCommentVNode("",!0)])),_:1},8,["label"])):Vue.createCommentVNode("",!0)])),_:1},8,["data"]),Vue.withDirectives(Vue.createVNode(m,{limit:N.value.page_size,"onUpdate:limit":a[4]||(a[4]=e=>N.value.page_size=e),page:N.value.page_num,"onUpdate:page":a[5]||(a[5]=e=>N.value.page_num=e),total:Vue.unref(y),onPagination:Vue.unref(P)},null,8,["limit","page","total","onPagination"]),[[Vue.vShow,Vue.unref(y)>0]]),v.value?(Vue.openBlock(),Vue.createBlock(f,{key:0,"form-data":k.value,open:v.value,title:C.value,onCloseDialog:T},null,8,["form-data","open","title"])):Vue.createCommentVNode("",!0)]))}});export{E as default};
