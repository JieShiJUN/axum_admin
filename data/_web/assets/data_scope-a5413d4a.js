import{s as e,r as t,p as u,d as a}from"./index-174ad176.js";import{u as l,n as o,E as n}from"./index.js";import{u as r,P as V,a as d}from"./pagination-87b07e34.js";import{R as i}from"./right-tool-bar-f10e816b.js";import{u as c}from"./useFormUtil-98c17c20.js";import{u as s}from"./useTableUtil-0e4d2f9a.js";import"./_plugin-vue_export-helper-0909ef10.js";var m=(e=>(e.getList="/test/data_scope/list",e.add="/test/data_scope/add",e.delete="/test/data_scope/delete",e))(m||{});const p={class:"app-container"},f=Vue.createElementVNode("span",null,[Vue.createTextVNode(" 数据权限测试：user 为部门A2,"),Vue.createElementVNode("br"),Vue.createTextVNode(" -- 右上角头像切换角色"),Vue.createElementVNode("br"),Vue.createTextVNode(" 1：超级管理员为全部权限:显示全部数据"),Vue.createElementVNode("br"),Vue.createTextVNode(" 2：自定数据权限：显示部门A1数据"),Vue.createElementVNode("br"),Vue.createTextVNode(" 3：本部门数据权限：显示部门A2数据"),Vue.createElementVNode("br"),Vue.createTextVNode(" 4：本部门及以下数据权限：显示部门A2及以下数据(包括A21)"),Vue.createElementVNode("br"),Vue.createTextVNode(" 5：仅本人数据权限:显示本人数据"),Vue.createElementVNode("br")],-1),E={class:"dialog-footer"},_=Vue.defineComponent({name:"data-scope"}),N=Vue.defineComponent({..._,setup(_){const N=l(),{useTableSelectChange:b}=s(),{formReset:h,formValidate:v}=c(),x=Vue.ref(!1),w=Vue.ref(!0),g=Vue.ref(""),C=Vue.ref(),P=Vue.ref(),y=Vue.ref({page_num:1,page_size:10,data_a:void 0,data_b:void 0,__r__:N.user.role}),T=Vue.ref({}),B=Vue.ref({data_a:[{required:!0,message:"岗位名称不能为空",trigger:"blur"}],data_b:[{required:!0,message:"岗位编码不能为空",trigger:"blur"}]}),{list:I,getListFn:F,total:U}=r(m.getList,y),{handleSelectionChangeFn:k,ids:A,values:K,selected:S}=b(),j=e=>k(e,"id","id");function R(){x.value=!1,q()}function q(){T.value={id:void 0,data_a:void 0,data_b:void 0}}function z(){y.value.page_num=1,F()}function D(){h(C.value),z()}function L(){q(),x.value=!0,g.value="添加"}async function Q(){if(!(await v(P.value)))return;const{execute:e,data:t}=o(m.add,T);await e(),t.value!==n&&(ElementPlus.ElMessage.success("新增成功"),R())}return(l,o)=>(Vue.openBlock(),Vue.createElementBlock("div",p,[f,Vue.withDirectives(Vue.createVNode(Vue.unref(ElementPlus.ElForm),{model:y.value,ref_key:"queryRef",ref:C,inline:!0,"label-width":"68px"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"Id",prop:"id"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:y.value.id,"onUpdate:modelValue":o[0]||(o[0]=e=>y.value.id=e),placeholder:"请输入id",clearable:"",onKeyup:Vue.withKeys(z,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"dataA",prop:"data_a"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:y.value.data_a,"onUpdate:modelValue":o[1]||(o[1]=e=>y.value.data_a=e),placeholder:"请输入A",clearable:"",onKeyup:Vue.withKeys(z,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"dataB",prop:"data_b"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:y.value.data_b,"onUpdate:modelValue":o[2]||(o[2]=e=>y.value.data_b=e),placeholder:"请输入B",clearable:"",onKeyup:Vue.withKeys(z,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),null,{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{type:"primary",icon:Vue.unref(e),onClick:z},{default:Vue.withCtx((()=>[Vue.createTextVNode("搜索")])),_:1},8,["icon"]),Vue.createVNode(Vue.unref(ElementPlus.ElButton),{icon:Vue.unref(t),onClick:D},{default:Vue.withCtx((()=>[Vue.createTextVNode("重置")])),_:1},8,["icon"])])),_:1})])),_:1},8,["model"]),[[Vue.vShow,w.value]]),Vue.createVNode(Vue.unref(ElementPlus.ElRow),{gutter:10,class:"mb8",style:{height:"35px"}},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:1.5},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{type:"primary",plain:"",icon:Vue.unref(u),onClick:L},{default:Vue.withCtx((()=>[Vue.createTextVNode(" 新增 ")])),_:1},8,["icon"])])),_:1},8,["span"]),Vue.createVNode(Vue.unref(ElementPlus.ElCol),{span:1.5},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{type:"danger",plain:"",icon:Vue.unref(a),disabled:!Vue.unref(S),onClick:o[3]||(o[3]=e=>(async e=>{await d(m.delete,"id",A,"id",K,"ids",e)&&await F()})())},{default:Vue.withCtx((()=>[Vue.createTextVNode("删除")])),_:1},8,["icon","disabled"])])),_:1},8,["span"]),Vue.createVNode(i,{showSearch:w.value,"onUpdate:showSearch":o[4]||(o[4]=e=>w.value=e),onQueryTable:Vue.unref(F)},null,8,["showSearch","onQueryTable"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElTable),{data:Vue.unref(I),onSelectionChange:j},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{type:"selection",width:"55",align:"center"}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"id",align:"center",prop:"id"}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"数据A",align:"center",prop:"data_a"}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"数据B",align:"center",prop:"data_b"}),Vue.createVNode(Vue.unref(ElementPlus.ElTableColumn),{label:"创建人",align:"center",prop:"created_by"})])),_:1},8,["data"]),Vue.withDirectives(Vue.createVNode(V,{total:Vue.unref(U),page:y.value.page_num,"onUpdate:page":o[5]||(o[5]=e=>y.value.page_num=e),limit:y.value.page_size,"onUpdate:limit":o[6]||(o[6]=e=>y.value.page_size=e),onPagination:Vue.unref(F)},null,8,["total","page","limit","onPagination"]),[[Vue.vShow,Vue.unref(U)>0]]),Vue.createVNode(Vue.unref(ElementPlus.ElDialog),{title:g.value,modelValue:x.value,"onUpdate:modelValue":o[9]||(o[9]=e=>x.value=e),width:"500px","append-to-body":""},{footer:Vue.withCtx((()=>[Vue.createElementVNode("div",E,[Vue.createVNode(Vue.unref(ElementPlus.ElButton),{type:"primary",onClick:Q},{default:Vue.withCtx((()=>[Vue.createTextVNode("确 定")])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElButton),{onClick:R},{default:Vue.withCtx((()=>[Vue.createTextVNode("取 消")])),_:1})])])),default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElForm),{ref_key:"formRef",ref:P,model:T.value,rules:B.value,"label-width":"80px"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"data_a",prop:"data_a"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:T.value.data_a,"onUpdate:modelValue":o[7]||(o[7]=e=>T.value.data_a=e),placeholder:"A"},null,8,["modelValue"])])),_:1}),Vue.createVNode(Vue.unref(ElementPlus.ElFormItem),{label:"data_b",prop:"data_b"},{default:Vue.withCtx((()=>[Vue.createVNode(Vue.unref(ElementPlus.ElInput),{modelValue:T.value.data_b,"onUpdate:modelValue":o[8]||(o[8]=e=>T.value.data_b=e),placeholder:"B"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])]))}});export{N as default};
