import{a0 as Oe,D as Me,g as p,a9 as Ae,a3 as Ee,R as Fe,r as d,aa as te,o as u,i as C,j as l,w as t,m as j,V as b,W as ae,k as s,a7 as ne,y as S,B as $,c as r,l as h,t as se,z as v,P as Ye}from"./vendor.8d886737.js";import{t as oe}from"./dept.96e12fd0.js";import{l as Le}from"./post.9255b710.js";import{l as Qe}from"./role.8100c124.js";import{m as Ie,n as We,o as Ge,p as He,d as Je,q as Xe,t as Ze}from"./index.c83df884.js";const el={class:"app-container"},ll={class:"head-container"},tl={class:"head-container"},al=v("\u641C\u7D22"),nl=v("\u91CD\u7F6E"),sl=v("\u65B0\u589E"),ol=v("\u4FEE\u6539"),ul=v("\u5220\u9664"),dl=v("\u4FEE\u6539"),rl=v("\u5220\u9664"),il={class:"el-dropdown-link"},pl=v("\u66F4\u591A "),_l=v("\u91CD\u7F6E\u5BC6\u7801"),ml=v("\u5206\u914D\u89D2\u8272"),cl={class:"dialog-footer"},fl=v("\u786E \u5B9A"),vl=v("\u53D6 \u6D88"),hl=Oe({name:"User"}),xl=Object.assign(hl,{setup(bl){const ue=Me(),{proxy:f}=Ye(),{sys_normal_disable:F,sys_user_sex:de}=f.useDict("sys_normal_disable","sys_user_sex"),Y=p([]),x=p(!1),B=p(!0),N=p(!0),K=p([]),L=p([]),Q=p(!0),I=p(!0),O=p(0),M=p(""),D=p([]),A=p(""),z=p(void 0),re=p(void 0),W=p([]),G=p([]),w=p([{key:0,label:"\u7528\u6237\u7F16\u53F7",visible:!0},{key:1,label:"\u7528\u6237\u540D\u79F0",visible:!0},{key:2,label:"\u7528\u6237\u6635\u79F0",visible:!0},{key:3,label:"\u90E8\u95E8",visible:!0},{key:4,label:"\u624B\u673A\u53F7\u7801",visible:!0},{key:5,label:"\u72B6\u6001",visible:!0},{key:6,label:"\u521B\u5EFA\u65F6\u95F4",visible:!0}]),ie=Ae({form:{},queryParams:{page_num:1,page_size:10,user_name:void 0,phone_num:void 0,user_status:void 0,dept_id:void 0},rules:{user_name:[{required:!0,message:"\u7528\u6237\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:2,max:20,message:"\u7528\u6237\u540D\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],user_nickname:[{required:!0,message:"\u7528\u6237\u6635\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],user_password:[{required:!0,message:"\u7528\u6237\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:5,max:20,message:"\u7528\u6237\u5BC6\u7801\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 5 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],user_email:[{type:"email",message:"'\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur","change"]}],phone_num:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}]}}),{queryParams:c,form:o,rules:pe}=Ee(ie),_e=(n,a)=>n?a.label.indexOf(n)!==-1:!0;Fe(A,n=>{f.$refs.deptTreeRef.filter(n)});function me(){oe().then(n=>{z.value=n})}function U(){B.value=!0,Ie(f.addDateRange(c.value,D.value)).then(n=>{B.value=!1,Y.value=n.list,O.value=n.total})}function ce(n){c.value.dept_id=n.dept_id,P()}function P(){c.value.page_num=1,U()}function fe(){D.value=[],c.value.dept_id=void 0,f.resetForm("queryRef"),P()}function H(n){const a=n.id?[n.id]:K.value,i=n.id?n.user_name:L.value;f.$modal.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u7528\u6237\u4E3A"'+i+'"\u7684\u6570\u636E\u9879\uFF1F').then(function(){return We({user_id:a})}).then(()=>{U(),f.$modal.msgSuccess("\u5220\u9664\u6210\u529F")}).catch(()=>{})}function ve(n){let a=n.user_status==="1"?"\u542F\u7528":"\u505C\u7528";f.$modal.confirm('\u786E\u8BA4\u8981"'+a+'""'+n.user_name+'"\u7528\u6237\u5417?').then(function(){return Ge(n.id,n.user_status)}).then(()=>{f.$modal.msgSuccess(a+"\u6210\u529F")}).catch(function(){n.user_status=n.user_status==="0"?"1":"0"})}function he(n,a){switch(n){case"handleResetPwd":ge(a);break;case"handleAuthRole":be(a);break}}function be(n){const a=n.id;ue.push("/system/user-auth/role/"+a)}function ge(n){f.$prompt('\u8BF7\u8F93\u5165"'+n.user_name+'"\u7684\u65B0\u5BC6\u7801',"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",closeOnClickModal:!1,inputPattern:/^.{5,20}$/,inputErrorMessage:"\u7528\u6237\u5BC6\u7801\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 5 \u548C 20 \u4E4B\u95F4"}).then(({value:a})=>{He(n.id,a).then(i=>{f.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F\uFF0C\u65B0\u5BC6\u7801\u662F\uFF1A"+a)})}).catch(()=>{})}function ye(n){K.value=n.map(a=>a.id),L.value=n.map(a=>a.user_name),Q.value=n.length!=1,I.value=!n.length}function J(){z.value===void 0&&oe().then(n=>{z.value=n})}function E(){o.value={id:void 0,dept_id:void 0,user_name:void 0,user_nickname:void 0,user_password:void 0,phone_num:void 0,user_email:void 0,sex:void 0,user_status:"1",remark:void 0,post_ids:[],role_ids:[]},f.resetForm("userRef")}function we(){x.value=!1,E()}function ke(){E(),J(),Z(),x.value=!0,M.value="\u6DFB\u52A0\u7528\u6237",o.value.user_password=re.value}async function X(n){E(),J();const a=n.id||K.value[0],i=await Je({user_id:a});o.value=i.user_info,o.value.post_ids=i.post_ids,o.value.role_ids=i.role_ids,Z(),x.value=!0,M.value="\u4FEE\u6539\u7528\u6237",o.password=""}async function Z(){let n={page_num:1,page_size:999999999};const{list:a}=await Le(n),{list:i}=await Qe(n);W.value=a,G.value=i}function Ve(){f.$refs.userRef.validate(n=>{n&&(o.value.id!=null?Xe(o.value).then(a=>{f.$modal.msgSuccess("\u4FEE\u6539\u6210\u529F"),x.value=!1,U()}):Ze(o.value).then(a=>{f.$modal.msgSuccess("\u65B0\u589E\u6210\u529F"),x.value=!1,U()}))})}return me(),U(),(n,a)=>{const i=d("el-input"),xe=d("el-tree"),_=d("el-col"),m=d("el-form-item"),q=d("el-option"),T=d("el-select"),Ue=d("el-date-picker"),g=d("el-button"),ee=d("el-form"),Ce=d("right-toolbar"),k=d("el-row"),y=d("el-table-column"),Re=d("el-switch"),ze=d("d-arrow-right"),Pe=d("el-icon"),le=d("el-dropdown-item"),Se=d("el-dropdown-menu"),$e=d("el-dropdown"),De=d("el-table"),qe=d("pagination"),Te=d("tree-select"),je=d("el-radio"),Be=d("el-radio-group"),Ne=d("el-dialog"),V=te("hasPermi"),Ke=te("loading");return u(),C("div",el,[l(k,{gutter:20},{default:t(()=>[l(_,{span:4,xs:24},{default:t(()=>[j("div",ll,[l(i,{modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value=e),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",clearable:"",size:"small","prefix-icon":"el-icon-search",style:{"margin-bottom":"20px"}},null,8,["modelValue"])]),j("div",tl,[l(xe,{data:z.value,props:{label:"dept_name",children:"children"},"expand-on-click-node":!1,"filter-node-method":_e,ref:"deptTreeRef","default-expand-all":"",onNodeClick:ce},null,8,["data"])])]),_:1}),l(_,{span:20,xs:24},{default:t(()=>[b(l(ee,{model:s(c),ref:"queryRef",inline:!0,"label-width":"68px"},{default:t(()=>[l(m,{label:"\u7528\u6237\u540D\u79F0",prop:"user_name"},{default:t(()=>[l(i,{modelValue:s(c).user_name,"onUpdate:modelValue":a[1]||(a[1]=e=>s(c).user_name=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",clearable:"",size:"small",style:{width:"240px"},onKeyup:ne(P,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(m,{label:"\u624B\u673A\u53F7\u7801",prop:"phone_num"},{default:t(()=>[l(i,{modelValue:s(c).phone_num,"onUpdate:modelValue":a[2]||(a[2]=e=>s(c).phone_num=e),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",clearable:"",size:"small",style:{width:"240px"},onKeyup:ne(P,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),l(m,{label:"\u72B6\u6001",prop:"user_status"},{default:t(()=>[l(T,{modelValue:s(c).user_status,"onUpdate:modelValue":a[3]||(a[3]=e=>s(c).user_status=e),placeholder:"\u7528\u6237\u72B6\u6001",clearable:"",size:"small",style:{width:"240px"}},{default:t(()=>[(u(!0),C(S,null,$(s(F),e=>(u(),r(q,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"\u521B\u5EFA\u65F6\u95F4"},{default:t(()=>[l(Ue,{modelValue:D.value,"onUpdate:modelValue":a[4]||(a[4]=e=>D.value=e),size:"small",style:{width:"240px"},"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),_:1}),l(m,null,{default:t(()=>[l(g,{type:"primary",icon:"Search",size:"mini",onClick:P},{default:t(()=>[al]),_:1}),l(g,{icon:"Refresh",size:"mini",onClick:fe},{default:t(()=>[nl]),_:1})]),_:1})]),_:1},8,["model"]),[[ae,N.value]]),l(k,{gutter:10,class:"mb8"},{default:t(()=>[l(_,{span:1.5},{default:t(()=>[b((u(),r(g,{type:"primary",plain:"",icon:"Plus",size:"mini",onClick:ke},{default:t(()=>[sl]),_:1})),[[V,["system:user:add"]]])]),_:1},8,["span"]),l(_,{span:1.5},{default:t(()=>[b((u(),r(g,{type:"success",plain:"",icon:"Edit",size:"mini",disabled:Q.value,onClick:X},{default:t(()=>[ol]),_:1},8,["disabled"])),[[V,["system:user:edit"]]])]),_:1},8,["span"]),l(_,{span:1.5},{default:t(()=>[b((u(),r(g,{type:"danger",plain:"",icon:"Delete",size:"mini",disabled:I.value,onClick:H},{default:t(()=>[ul]),_:1},8,["disabled"])),[[V,["system:user:remove"]]])]),_:1},8,["span"]),l(Ce,{showSearch:N.value,"onUpdate:showSearch":a[5]||(a[5]=e=>N.value=e),onQueryTable:U,columns:w.value},null,8,["showSearch","columns"])]),_:1}),b((u(),r(De,{data:Y.value,onSelectionChange:ye},{default:t(()=>[l(y,{type:"selection",width:"50",align:"center"}),w.value[0].visible?(u(),r(y,{label:"\u7528\u6237\u7F16\u53F7",align:"center",key:"id",prop:"id",width:"100","show-overflow-tooltip":""})):h("",!0),w.value[1].visible?(u(),r(y,{label:"\u7528\u6237\u540D\u79F0",align:"center",key:"user_name",prop:"user_name","show-overflow-tooltip":!0})):h("",!0),w.value[2].visible?(u(),r(y,{label:"\u7528\u6237\u6635\u79F0",align:"center",key:"user_nickname",prop:"user_nickname","show-overflow-tooltip":!0})):h("",!0),w.value[3].visible?(u(),r(y,{label:"\u90E8\u95E8",align:"center",key:"dept_id",prop:"dept.dept_name","show-overflow-tooltip":!0})):h("",!0),w.value[4].visible?(u(),r(y,{label:"\u624B\u673A\u53F7\u7801",align:"center",key:"phone_num",prop:"phone_num",width:"120"})):h("",!0),w.value[5].visible?(u(),r(y,{label:"\u72B6\u6001",align:"center",key:"user_status"},{default:t(e=>[l(Re,{modelValue:e.row.user_status,"onUpdate:modelValue":R=>e.row.user_status=R,"active-value":"1","inactive-value":"0",onChange:R=>ve(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):h("",!0),w.value[6].visible?(u(),r(y,{key:6,label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"created_at",width:"150"},{default:t(e=>[j("span",null,se(n.parseTime(e.row.created_at)),1)]),_:1})):h("",!0),l(y,{label:"\u64CD\u4F5C",align:"center",width:"180","class-name":"small-padding fixed-width"},{default:t(e=>[e.row.user_id!==1?b((u(),r(g,{key:0,size:"mini",type:"text",icon:"Edit",onClick:R=>X(e.row)},{default:t(()=>[dl]),_:2},1032,["onClick"])),[[V,["system:user:edit"]]]):h("",!0),e.row.user_id!==1?b((u(),r(g,{key:1,size:"mini",type:"text",icon:"Delete",onClick:R=>H(e.row)},{default:t(()=>[rl]),_:2},1032,["onClick"])),[[V,["system:user:remove"]]]):h("",!0),e.row.user_id!==1?(u(),r($e,{key:2,onCommand:R=>he(R,e.row)},{dropdown:t(()=>[l(Se,null,{default:t(()=>[b((u(),r(le,{command:"handleResetPwd",icon:"Key"},{default:t(()=>[_l]),_:1})),[[V,["system:user:resetPwd"]]]),b((u(),r(le,{command:"handleAuthRole",icon:"CircleCheck"},{default:t(()=>[ml]),_:1})),[[V,["system:user:edit"]]])]),_:1})]),default:t(()=>[b((u(),C("span",il,[l(Pe,null,{default:t(()=>[l(ze)]),_:1}),pl])),[[V,["system:user:resetPwd","system:user:edit"]]])]),_:2},1032,["onCommand"])):h("",!0)]),_:1})]),_:1},8,["data"])),[[Ke,B.value]]),b(l(qe,{total:O.value,page:s(c).page_num,"onUpdate:page":a[6]||(a[6]=e=>s(c).page_num=e),limit:s(c).page_size,"onUpdate:limit":a[7]||(a[7]=e=>s(c).page_size=e),onPagination:U},null,8,["total","page","limit"]),[[ae,O.value>0]])]),_:1})]),_:1}),l(Ne,{title:M.value,modelValue:x.value,"onUpdate:modelValue":a[19]||(a[19]=e=>x.value=e),width:"600px","append-to-body":""},{footer:t(()=>[j("div",cl,[l(g,{type:"primary",onClick:Ve},{default:t(()=>[fl]),_:1}),l(g,{onClick:we},{default:t(()=>[vl]),_:1})])]),default:t(()=>[l(ee,{model:s(o),rules:s(pe),ref:"userRef","label-width":"80px"},{default:t(()=>[l(k,null,{default:t(()=>[l(_,{span:12},{default:t(()=>[l(m,{label:"\u7528\u6237\u6635\u79F0",prop:"user_nickname"},{default:t(()=>[l(i,{modelValue:s(o).user_nickname,"onUpdate:modelValue":a[8]||(a[8]=e=>s(o).user_nickname=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6635\u79F0",maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),l(_,{span:12},{default:t(()=>[l(m,{label:"\u5F52\u5C5E\u90E8\u95E8",prop:"dept_id"},{default:t(()=>[l(Te,{value:s(o).dept_id,"onUpdate:value":a[9]||(a[9]=e=>s(o).dept_id=e),options:z.value,placeholder:"\u8BF7\u9009\u62E9\u5F52\u5C5E\u90E8\u95E8",objMap:{value:"dept_id",label:"dept_name",children:"children"}},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(_,{span:12},{default:t(()=>[l(m,{label:"\u624B\u673A\u53F7\u7801",prop:"phone_num"},{default:t(()=>[l(i,{modelValue:s(o).phone_num,"onUpdate:modelValue":a[10]||(a[10]=e=>s(o).phone_num=e),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",maxlength:"11"},null,8,["modelValue"])]),_:1})]),_:1}),l(_,{span:12},{default:t(()=>[l(m,{label:"\u90AE\u7BB1",prop:"email"},{default:t(()=>[l(i,{modelValue:s(o).user_email,"onUpdate:modelValue":a[11]||(a[11]=e=>s(o).user_email=e),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(_,{span:12},{default:t(()=>[s(o).id==null?(u(),r(m,{key:0,label:"\u7528\u6237\u540D\u79F0",prop:"user_name"},{default:t(()=>[l(i,{modelValue:s(o).user_name,"onUpdate:modelValue":a[12]||(a[12]=e=>s(o).user_name=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",maxlength:"30"},null,8,["modelValue"])]),_:1})):h("",!0)]),_:1}),l(_,{span:12},{default:t(()=>[s(o).id==null?(u(),r(m,{key:0,label:"\u7528\u6237\u5BC6\u7801",prop:"user_password"},{default:t(()=>[l(i,{modelValue:s(o).user_password,"onUpdate:modelValue":a[13]||(a[13]=e=>s(o).user_password=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u5BC6\u7801",type:"password",maxlength:"20","show-password":""},null,8,["modelValue"])]),_:1})):h("",!0)]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(_,{span:12},{default:t(()=>[l(m,{label:"\u7528\u6237\u6027\u522B"},{default:t(()=>[l(T,{modelValue:s(o).sex,"onUpdate:modelValue":a[14]||(a[14]=e=>s(o).sex=e),placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(u(!0),C(S,null,$(s(de),e=>(u(),r(q,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(_,{span:12},{default:t(()=>[l(m,{label:"\u72B6\u6001"},{default:t(()=>[l(Be,{modelValue:s(o).user_status,"onUpdate:modelValue":a[15]||(a[15]=e=>s(o).user_status=e)},{default:t(()=>[(u(!0),C(S,null,$(s(F),e=>(u(),r(je,{key:e.value,label:e.value},{default:t(()=>[v(se(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(_,{span:12},{default:t(()=>[l(m,{label:"\u5C97\u4F4D"},{default:t(()=>[l(T,{modelValue:s(o).post_ids,"onUpdate:modelValue":a[16]||(a[16]=e=>s(o).post_ids=e),multiple:"",placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(u(!0),C(S,null,$(W.value,e=>(u(),r(q,{key:e.post_id,label:e.post_name,value:e.post_id,disabled:e.status=="0"},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(_,{span:12},{default:t(()=>[l(m,{label:"\u89D2\u8272"},{default:t(()=>[l(T,{modelValue:s(o).role_ids,"onUpdate:modelValue":a[17]||(a[17]=e=>s(o).role_ids=e),multiple:"",placeholder:"\u8BF7\u9009\u62E9"},{default:t(()=>[(u(!0),C(S,null,$(G.value,e=>(u(),r(q,{key:e.role_id,label:e.role_name,value:e.role_id,disabled:e.status=="0"},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(k,null,{default:t(()=>[l(_,{span:24},{default:t(()=>[l(m,{label:"\u5907\u6CE8"},{default:t(()=>[l(i,{modelValue:s(o).remark,"onUpdate:modelValue":a[18]||(a[18]=e=>s(o).remark=e),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{xl as default};
