import{a1 as z,D as E,g as i,r as n,ab as O,o as C,i as P,j as o,w as a,W as S,c as q,X as F,p as m,S as K,t as V,A as $,Q}from"./vendor.dda3acc4.js";import{l as W,d as X,e as G}from"./index.6a9993b0.js";const H={class:"app-container"},J=m("h4",{class:"form-header h4"},"\u57FA\u672C\u4FE1\u606F",-1),L=m("h4",{class:"form-header h4"},"\u89D2\u8272\u4FE1\u606F",-1),M={style:{"text-align":"center","margin-left":"-120px","margin-top":"30px"}},Y=$("\u63D0\u4EA4"),Z=$("\u8FD4\u56DE"),ee=z({name:"AuthRole"}),ae=Object.assign(ee,{setup(oe){const h=E(),{proxy:d}=Q(),g=i(!0),b=i(0),c=i(1),_=i(10),k=i([]),w=i([]),s=i({nickName:void 0,userName:void 0,userId:void 0});function N(t){d.$refs.roleRef.toggleRowSelection(t)}function U(t){k.value=t.map(e=>e.role_id)}function j(t){return t.role_id}function x(){d.$router.back(),d.$tab.closeOpenPage()}function B(){const t=s.value.id,e=k.value;console.log("user_id",t),console.log("role_ids",e),G({user_id:t,role_ids:e}).then(r=>{d.$modal.msgSuccess("\u6388\u6743\u6210\u529F"),x()})}async function D(){const t=h.params&&h.params.userId,e={page_num:1,page_size:9999999999};if(t){g.value=!0;const r=await W(e);w.value=r.list,b.value=r.total;const p=await X({user_id:t});s.value=p.user_info;const f=p.role_ids;K(()=>{w.value.forEach(v=>{f.includes(v.role_id)&&d.$refs.roleRef.toggleRowSelection(v)})}),g.value=!1}}return D(),(t,e)=>{const r=n("el-input"),p=n("el-form-item"),f=n("el-col"),v=n("el-row"),y=n("el-form"),u=n("el-table-column"),I=n("el-table"),A=n("pagination"),R=n("el-button"),T=O("loading");return C(),P("div",H,[J,o(y,{model:s.value,"label-width":"80px"},{default:a(()=>[o(v,null,{default:a(()=>[o(f,{span:8,offset:2},{default:a(()=>[o(p,{label:"\u7528\u6237\u6635\u79F0",prop:"user_nickname"},{default:a(()=>[o(r,{modelValue:s.value.user_nickname,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.user_nickname=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),o(f,{span:8,offset:2},{default:a(()=>[o(p,{label:"\u767B\u5F55\u8D26\u53F7",prop:"user_name"},{default:a(()=>[o(r,{modelValue:s.value.user_name,"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.user_name=l),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),L,S((C(),q(I,{"row-key":j,onRowClick:N,ref:"roleRef",onSelectionChange:U,data:w.value.slice((c.value-1)*_.value,c.value*_.value)},{default:a(()=>[o(u,{label:"\u5E8F\u53F7",type:"index",align:"center"},{default:a(l=>[m("span",null,V((c.value-1)*_.value+l.$index+1),1)]),_:1}),o(u,{type:"selection","reserve-selection":!0,width:"55"}),o(u,{label:"\u89D2\u8272\u7F16\u53F7",align:"center",prop:"role_id",width:"100","show-overflow-tooltip":""}),o(u,{label:"\u89D2\u8272\u540D\u79F0",align:"center",prop:"role_name"}),o(u,{label:"\u6743\u9650\u5B57\u7B26",align:"center",prop:"role_key"}),o(u,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"created_at",width:"180"},{default:a(l=>[m("span",null,V(t.parseTime(l.row.created_at)),1)]),_:1})]),_:1},8,["data"])),[[T,g.value]]),S(o(A,{total:b.value,page:c.value,"onUpdate:page":e[2]||(e[2]=l=>c.value=l),limit:_.value,"onUpdate:limit":e[3]||(e[3]=l=>_.value=l)},null,8,["total","page","limit"]),[[F,b.value>0]]),o(y,{"label-width":"100px"},{default:a(()=>[m("div",M,[o(R,{type:"primary",onClick:e[4]||(e[4]=l=>B())},{default:a(()=>[Y]),_:1}),o(R,{onClick:e[5]||(e[5]=l=>x())},{default:a(()=>[Z]),_:1})])]),_:1})])}}});export{ae as default};
